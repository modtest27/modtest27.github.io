(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3778],{24530:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/learn-pages-router/basics/data-fetching/blog-data",function(){return t(7465)}])},25928:(e,a,t)=>{"use strict";t.d(a,{Z:()=>y});var n=t(58589),s=t(51853),o=t.n(s),p=t(10628),r=t(14517);function c(e,a){return i(a.root,e.root)&&i(a.rootMargin,e.rootMargin)&&i(a.threshold,e.thresholds)}function m(e){if(!/^-?\d*\.?\d+(?:px|%)$/.test(e))throw Error("rootMargin must be specified as a CSS margin property")}function i(e,a){return Array.isArray(e)&&Array.isArray(a)&&e.length===a.length?e.every((t,n)=>i(e[n],a[n])):e===a}t(81324);let l=function(){let e=new Map;function a(a){return e.has(a)?e.get(a):e.set(a,new Map).get(a)}function t(e,t){for(let n of e){let e=a(t).get(n.target);e&&e(n)}}return{getObserver:function(a){return function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(){var e;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{root:a.root||null,rootMargin:function(e){let a=(e||"0px").trim().split(/\s+/);return a.forEach(m),a[1]=a[1]||a[0],a[2]=a[2]||a[0],a[3]=a[3]||a[1],a.join(" ")}(a.rootMargin),threshold:Array.isArray(e=a.threshold)?e:[void 0!==e?e:0]}}(a);for(let a of e.keys())if(c(a,t))return a;return null}(a)||new IntersectionObserver(t,a)},observeTarget:function(e,t,n){a(e).set(t,n),e.observe(t)},unobserveTarget:function(e,t){a(e).delete(t),e.unobserve(t)}}}(),{getObserver:d}=l,{observeTarget:k}=l,{unobserveTarget:N}=l;class u extends p.Component{static #e=this.defaultProps={disabled:!1,once:!1};componentDidMount(){this.observer=d(h(this.props)),this.observe()}UNSAFE_componentWillReceiveProps(e){let a=h(e);c(this.observer,a)||(this.unobserve(),this.observer=d(a),this.shouldReobserve=!0),this.props.disabled&&!e.disabled&&(this.shouldReobserve=!0),!this.props.disabled&&e.disabled&&this.unobserve()}componentDidUpdate(){this.shouldReobserve&&(this.observe(),this.shouldReobserve=!1)}componentWillUnmount(){this.unobserve()}observe(){this.props.disabled||k(this.observer,this.target,this.handleIntersect)}unobserve(){N(this.observer,this.target)}render(){return this.props.render?this.props.render({innerRef:this.handleTarget}):(0,p.cloneElement)(p.Children.only(this.props.children),{ref:this.handleTarget})}constructor(...e){super(...e),this.shouldReobserve=!1,this.handleTarget=e=>{if(null!==e&&"object"==typeof e&&!function(e){return e&&"function"==typeof e.getBoundingClientRect}(e))throw Error("Child did not forward the ref to a DOM element. Did you accidentally pass a class component?");this.target&&this.target!==e&&(this.unobserve(),this.shouldReobserve=!0),this.target=e},this.handleIntersect=e=>{this.props.onIntersect(e,this.props.value),this.props.once&&e.isIntersecting&&this.unobserve()}}}let h=e=>({root:e.root,rootMargin:e.rootMargin,threshold:e.threshold});function g(e){let{videoSrc:a,video:t,renderImage:s,src:o,alt:p}=e;return o?a||t?(0,n.jsx)("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,src:o}):s?s(e):(0,n.jsx)("img",{alt:p,src:o||null}):null}class f extends p.Component{static #e=this.defaultProps={lazy:!0};render(){let{caption:e,width:a,height:t,margin:s=40,video:p=!1,videoSrc:c,captionSpacing:m=null,renderImage:i,oversize:l=!0,float:d,lazy:k,shadow:N,style:h,...f}=this.props,y=`${String(t/a*100)}%`;return(0,n.jsx)(u,{disabled:!k,onIntersect:this.handleIntersect,once:!0,rootMargin:"20%",children:(0,n.jsxs)("figure",{className:o().dynamic([["622a55e2833827d7",[s,a?`width: ${a}px;`:"",N?"box-shadow: 0 8px 30px rgba(0,0,0,0.12)":"",a,s,s,a,d,s,d]]])+" "+((0,r.W)({oversize:a>650&&l,float:d&&a<520})||""),children:[(0,n.jsxs)("div",{className:o().dynamic([["622a55e2833827d7",[s,a?`width: ${a}px;`:"",N?"box-shadow: 0 8px 30px rgba(0,0,0,0.12)":"",a,s,s,a,d,s,d]]])+" container",children:[(0,n.jsx)("div",{style:{paddingBottom:y,...h},className:o().dynamic([["622a55e2833827d7",[s,a?`width: ${a}px;`:"",N?"box-shadow: 0 8px 30px rgba(0,0,0,0.12)":"",a,s,s,a,d,s,d]]]),children:(0,n.jsx)(g,{alt:f.alt,height:t,renderImage:i,video:p,videoSrc:c,width:a,...f,src:this.state.src})}),e?(0,n.jsx)("figcaption",{style:m?{marginTop:m}:{},className:o().dynamic([["622a55e2833827d7",[s,a?`width: ${a}px;`:"",N?"box-shadow: 0 8px 30px rgba(0,0,0,0.12)":"",a,s,s,a,d,s,d]]]),children:e}):null]}),(0,n.jsx)(o(),{id:"622a55e2833827d7",dynamic:[s,a?`width: ${a}px;`:"",N?"box-shadow: 0 8px 30px rgba(0,0,0,0.12)":"",a,s,s,a,d,s,d],children:`figure.__jsx-style-dynamic-selector{display:block;text-align:center;margin:${s}px 0}.container.__jsx-style-dynamic-selector{margin:0 auto;${a?`width: ${a}px;`:""}                max-width: 100%}@media screen and (max-width:320px){.container.__jsx-style-dynamic-selector{width:100%}}div.__jsx-style-dynamic-selector{-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);transform:translate3d(0,0,0);position:relative}figure.__jsx-style-dynamic-selector img,figure.__jsx-style-dynamic-selector video{height:100%;left:0;position:absolute;top:0;width:100%;${N?"box-shadow: 0 8px 30px rgba(0,0,0,0.12)":""}}figcaption.__jsx-style-dynamic-selector{color:#999;font-size:12px;margin:0;text-align:center}@media(min-width:1200px){figure.oversize.__jsx-style-dynamic-selector{width:${a}px;margin:${s}px 0 ${s}px -webkit-calc(((${a}px - 650px) / 2) * -1);margin:${s}px 0 ${s}px -moz-calc(((${a}px - 650px) / 2) * -1);margin:${s}px 0 ${s}px calc(((${a}px - 650px) / 2) * -1)}figure.float.__jsx-style-dynamic-selector{float:${d};margin:${s}px;margin-${d}:-150px}}`})]})})}constructor(...e){super(...e),this.state={src:this.props.lazy?void 0:this.props.videoSrc||this.props.src},this.handleIntersect=e=>{e.isIntersecting&&this.setState({src:this.props.videoSrc||this.props.src})}}}let y=function(e){return(0,n.jsx)(f,{...e,alt:""})}},7465:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>m,meta:()=>p}),t(10628);var n=t(16942),s=t(18590),o=t(25928);let p={title:"Pre-rendering and Data Fetching",courseId:"basics",lessonId:"data-fetching",stepId:"blog-data",subtitle:"Creating a simple blog architecture"},r={meta:p},c=e=>{let{children:a}=e;return(0,n.kt)(s.Z,{meta:p},a)};function m(e){let{components:a,...t}=e;return(0,n.kt)(c,{...r,...t,components:a,mdxType:"MDXLayout"},(0,n.kt)("p",null,"The blog posts in our example will be stored as local markdown files in our application's directory (not fetched from an external data source), so we'll need to read the data from the file system."),(0,n.kt)("p",null,"In this section, we'll go through the steps of creating a blog that reads markdown data from the file system."),(0,n.kt)("h3",null,"Creating the markdown files"),(0,n.kt)("p",null,"First, create a new top-level directory called ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"posts"))," (this is not the same as ",(0,n.kt)("inlineCode",{parentName:"p"},"pages/posts"),") in your root folder. Inside ",(0,n.kt)("inlineCode",{parentName:"p"},"posts"),", create two files: ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"pre-rendering.md"))," and ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"ssg-ssr.md")),"."),(0,n.kt)("p",null,"Now, copy the following code to ",(0,n.kt)("inlineCode",{parentName:"p"},"posts/pre-rendering.md"),":"),(0,n.kt)("pre",{className:"language-md"},(0,n.kt)("code",{parentName:"pre",className:"language-md"},(0,n.kt)("span",{parentName:"code",className:"token front-matter-block"},(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"---"),`
`,(0,n.kt)("span",{parentName:"span",className:"token front-matter yaml language-yaml"},`title: 'Two Forms of Pre-rendering'
date: '2020-01-01'`),`
`,(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"---")),`

Next.js has two forms of pre-rendering: `,(0,n.kt)("span",{parentName:"code",className:"token bold"},(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**"),(0,n.kt)("span",{parentName:"span",className:"token content"},"Static Generation"),(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**"))," and ",(0,n.kt)("span",{parentName:"code",className:"token bold"},(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**"),(0,n.kt)("span",{parentName:"span",className:"token content"},"Server-side Rendering"),(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**")),". The difference is in ",(0,n.kt)("span",{parentName:"code",className:"token bold"},(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**"),(0,n.kt)("span",{parentName:"span",className:"token content"},"when"),(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**")),` it generates the HTML for a page.

`,(0,n.kt)("span",{parentName:"code",className:"token list punctuation"},"-")," ",(0,n.kt)("span",{parentName:"code",className:"token bold"},(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**"),(0,n.kt)("span",{parentName:"span",className:"token content"},"Static Generation"),(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**"))," is the pre-rendering method that generates the HTML at ",(0,n.kt)("span",{parentName:"code",className:"token bold"},(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**"),(0,n.kt)("span",{parentName:"span",className:"token content"},"build time"),(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**")),". The pre-rendered HTML is then ",(0,n.kt)("span",{parentName:"code",className:"token italic"},(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"_"),(0,n.kt)("span",{parentName:"span",className:"token content"},"reused"),(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"_")),` on each request.
`,(0,n.kt)("span",{parentName:"code",className:"token list punctuation"},"-")," ",(0,n.kt)("span",{parentName:"code",className:"token bold"},(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**"),(0,n.kt)("span",{parentName:"span",className:"token content"},"Server-side Rendering"),(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**"))," is the pre-rendering method that generates the HTML on ",(0,n.kt)("span",{parentName:"code",className:"token bold"},(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**"),(0,n.kt)("span",{parentName:"span",className:"token content"},"each request"),(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**")),`.

Importantly, Next.js lets you `,(0,n.kt)("span",{parentName:"code",className:"token bold"},(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**"),(0,n.kt)("span",{parentName:"span",className:"token content"},"choose"),(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**")),` which pre-rendering form to use for each page. You can create a "hybrid" Next.js app by using Static Generation for most pages and using Server-side Rendering for others.
`)),(0,n.kt)("p",null,"Then, copy the following code to ",(0,n.kt)("inlineCode",{parentName:"p"},"posts/ssg-ssr.md"),":"),(0,n.kt)("pre",{className:"language-md"},(0,n.kt)("code",{parentName:"pre",className:"language-md"},(0,n.kt)("span",{parentName:"code",className:"token front-matter-block"},(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"---"),`
`,(0,n.kt)("span",{parentName:"span",className:"token front-matter yaml language-yaml"},`title: 'When to Use Static Generation v.s. Server-side Rendering'
date: '2020-01-02'`),`
`,(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"---")),`

We recommend using `,(0,n.kt)("span",{parentName:"code",className:"token bold"},(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**"),(0,n.kt)("span",{parentName:"span",className:"token content"},"Static Generation"),(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**")),` (with and without data) whenever possible because your page can be built once and served by CDN, which makes it much faster than having a server render the page on every request.

You can use Static Generation for many types of pages, including:

`,(0,n.kt)("span",{parentName:"code",className:"token list punctuation"},"-"),` Marketing pages
`,(0,n.kt)("span",{parentName:"code",className:"token list punctuation"},"-"),` Blog posts
`,(0,n.kt)("span",{parentName:"code",className:"token list punctuation"},"-"),` E-commerce product listings
`,(0,n.kt)("span",{parentName:"code",className:"token list punctuation"},"-"),` Help and documentation

You should ask yourself: "Can I pre-render this page `,(0,n.kt)("span",{parentName:"code",className:"token bold"},(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**"),(0,n.kt)("span",{parentName:"span",className:"token content"},"ahead"),(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**")),` of a user's request?" If the answer is yes, then you should choose Static Generation.

On the other hand, Static Generation is `,(0,n.kt)("span",{parentName:"code",className:"token bold"},(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**"),(0,n.kt)("span",{parentName:"span",className:"token content"},"not"),(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**")),` a good idea if you cannot pre-render a page ahead of a user's request. Maybe your page shows frequently updated data, and the page content changes on every request.

In that case, you can use `,(0,n.kt)("span",{parentName:"code",className:"token bold"},(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**"),(0,n.kt)("span",{parentName:"span",className:"token content"},"Server-Side Rendering"),(0,n.kt)("span",{parentName:"span",className:"token punctuation"},"**")),`. It will be slower, but the pre-rendered page will always be up-to-date. Or you can skip pre-rendering and use client-side JavaScript to populate data.
`)),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"You might have noticed that each markdown file has a metadata section at the top containing ",(0,n.kt)("inlineCode",{parentName:"p"},"title")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"date"),". This is called YAML Front Matter, which can be parsed using a library called ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/jonschlinkert/gray-matter"},"gray-matter"),".")),(0,n.kt)("h3",null,"Installing gray-matter"),(0,n.kt)("p",null,"First, install ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/jonschlinkert/gray-matter"},"gray-matter")," which lets us parse the metadata in each markdown file."),(0,n.kt)("pre",{className:"language-shell"},(0,n.kt)("code",{parentName:"pre",className:"language-shell"},(0,n.kt)("span",{parentName:"code",className:"token function"},"npm")," ",(0,n.kt)("span",{parentName:"code",className:"token function"},"install"),` gray-matter
`)),(0,n.kt)("h3",null,"Creating the utility function to read the file system"),(0,n.kt)("p",null,`Next, we’ll create a utility function for parsing data from the file system. With this utility function, we’d like to:`),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Parse each markdown file and get ",(0,n.kt)("inlineCode",{parentName:"li"},"title"),", ",(0,n.kt)("inlineCode",{parentName:"li"},"date"),", and file name (which will be used as ",(0,n.kt)("inlineCode",{parentName:"li"},"id")," for the post URL)."),(0,n.kt)("li",{parentName:"ul"},"List the data on the index page, sorted by date.")),(0,n.kt)("p",null,"Create a top-level directory called ",(0,n.kt)("inlineCode",{parentName:"p"},"lib")," in the root directory. Then, inside ",(0,n.kt)("inlineCode",{parentName:"p"},"lib"),", create a file called ",(0,n.kt)("inlineCode",{parentName:"p"},"posts.js"),", and copy and paste this code:"),(0,n.kt)("pre",{className:"language-js"},(0,n.kt)("code",{parentName:"pre",className:"language-js"},(0,n.kt)("span",{parentName:"code",className:"token keyword module"},"import")," ",(0,n.kt)("span",{parentName:"code",className:"token imports"},"fs")," ",(0,n.kt)("span",{parentName:"code",className:"token keyword module"},"from")," ",(0,n.kt)("span",{parentName:"code",className:"token string"},"'fs'"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},";"),`
`,(0,n.kt)("span",{parentName:"code",className:"token keyword module"},"import")," ",(0,n.kt)("span",{parentName:"code",className:"token imports"},"path")," ",(0,n.kt)("span",{parentName:"code",className:"token keyword module"},"from")," ",(0,n.kt)("span",{parentName:"code",className:"token string"},"'path'"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},";"),`
`,(0,n.kt)("span",{parentName:"code",className:"token keyword module"},"import")," ",(0,n.kt)("span",{parentName:"code",className:"token imports"},"matter")," ",(0,n.kt)("span",{parentName:"code",className:"token keyword module"},"from")," ",(0,n.kt)("span",{parentName:"code",className:"token string"},"'gray-matter'"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},";"),`

`,(0,n.kt)("span",{parentName:"code",className:"token keyword"},"const")," postsDirectory ",(0,n.kt)("span",{parentName:"code",className:"token operator"},"=")," path",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,n.kt)("span",{parentName:"code",className:"token method function property-access"},"join"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"("),"process",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,n.kt)("span",{parentName:"code",className:"token method function property-access"},"cwd"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,n.kt)("span",{parentName:"code",className:"token string"},"'posts'"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},";"),`

`,(0,n.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,n.kt)("span",{parentName:"code",className:"token keyword"},"function")," ",(0,n.kt)("span",{parentName:"code",className:"token function"},"getSortedPostsData"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"{"),`
  `,(0,n.kt)("span",{parentName:"code",className:"token comment"},"// Get file names under /posts"),`
  `,(0,n.kt)("span",{parentName:"code",className:"token keyword"},"const")," fileNames ",(0,n.kt)("span",{parentName:"code",className:"token operator"},"=")," fs",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,n.kt)("span",{parentName:"code",className:"token method function property-access"},"readdirSync"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"("),"postsDirectory",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},";"),`
  `,(0,n.kt)("span",{parentName:"code",className:"token keyword"},"const")," allPostsData ",(0,n.kt)("span",{parentName:"code",className:"token operator"},"=")," fileNames",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,n.kt)("span",{parentName:"code",className:"token method function property-access"},"map"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,n.kt)("span",{parentName:"code",className:"token parameter"},"fileName"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,n.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"{"),`
    `,(0,n.kt)("span",{parentName:"code",className:"token comment"},'// Remove ".md" from file name to get id'),`
    `,(0,n.kt)("span",{parentName:"code",className:"token keyword"},"const")," id ",(0,n.kt)("span",{parentName:"code",className:"token operator"},"=")," fileName",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,n.kt)("span",{parentName:"code",className:"token method function property-access"},"replace"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,n.kt)("span",{parentName:"code",className:"token regex"},(0,n.kt)("span",{parentName:"span",className:"token regex-delimiter"},"/"),(0,n.kt)("span",{parentName:"span",className:"token regex-source language-regex"},"\\.md$"),(0,n.kt)("span",{parentName:"span",className:"token regex-delimiter"},"/")),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,n.kt)("span",{parentName:"code",className:"token string"},"''"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},";"),`

    `,(0,n.kt)("span",{parentName:"code",className:"token comment"},"// Read markdown file as string"),`
    `,(0,n.kt)("span",{parentName:"code",className:"token keyword"},"const")," fullPath ",(0,n.kt)("span",{parentName:"code",className:"token operator"},"=")," path",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,n.kt)("span",{parentName:"code",className:"token method function property-access"},"join"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"("),"postsDirectory",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},",")," fileName",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},";"),`
    `,(0,n.kt)("span",{parentName:"code",className:"token keyword"},"const")," fileContents ",(0,n.kt)("span",{parentName:"code",className:"token operator"},"=")," fs",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,n.kt)("span",{parentName:"code",className:"token method function property-access"},"readFileSync"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"("),"fullPath",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,n.kt)("span",{parentName:"code",className:"token string"},"'utf8'"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},";"),`

    `,(0,n.kt)("span",{parentName:"code",className:"token comment"},"// Use gray-matter to parse the post metadata section"),`
    `,(0,n.kt)("span",{parentName:"code",className:"token keyword"},"const")," matterResult ",(0,n.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,n.kt)("span",{parentName:"code",className:"token function"},"matter"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"("),"fileContents",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},";"),`

    `,(0,n.kt)("span",{parentName:"code",className:"token comment"},"// Combine the data with the id"),`
    `,(0,n.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"{"),`
      id`,(0,n.kt)("span",{parentName:"code",className:"token punctuation"},","),`
      `,(0,n.kt)("span",{parentName:"code",className:"token spread operator"},"..."),"matterResult",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,n.kt)("span",{parentName:"code",className:"token property-access"},"data"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},","),`
    `,(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},";"),`
  `,(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},";"),`
  `,(0,n.kt)("span",{parentName:"code",className:"token comment"},"// Sort posts by date"),`
  `,(0,n.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," allPostsData",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,n.kt)("span",{parentName:"code",className:"token method function property-access"},"sort"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,n.kt)("span",{parentName:"code",className:"token parameter"},"a",(0,n.kt)("span",{parentName:"span",className:"token punctuation"},",")," b"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,n.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"{"),`
    `,(0,n.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"("),"a",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,n.kt)("span",{parentName:"code",className:"token property-access"},"date")," ",(0,n.kt)("span",{parentName:"code",className:"token operator"},"<")," b",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,n.kt)("span",{parentName:"code",className:"token property-access"},"date"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"{"),`
      `,(0,n.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,n.kt)("span",{parentName:"code",className:"token number"},"1"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},";"),`
    `,(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,n.kt)("span",{parentName:"code",className:"token keyword control-flow"},"else")," ",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"{"),`
      `,(0,n.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,n.kt)("span",{parentName:"code",className:"token operator"},"-"),(0,n.kt)("span",{parentName:"code",className:"token number"},"1"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},";"),`
    `,(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"}"),`
  `,(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},";"),`
`,(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"}"),`
`)),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},(0,n.kt)("strong",{parentName:"p"},"Note:")),(0,n.kt)("p",{parentName:"blockquote"},"You don't need to understand what the code above is doing in order to learn Next.js, the function is to make the blog example functional. But if you'd like to learn more:"),(0,n.kt)("ul",{parentName:"blockquote"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://nodejs.org/api/fs.html#fsreaddirsyncpath-options"},(0,n.kt)("inlineCode",{parentName:"a"},"fs"))," is a Node.js module that lets you read files from the file system."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://nodejs.org/api/path.html#pathjoinpaths"},(0,n.kt)("inlineCode",{parentName:"a"},"path"))," is a Node.js module that lets you manipulate file paths."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/gray-matter"},(0,n.kt)("inlineCode",{parentName:"a"},"matter"))," is a library that lets you parse the metadata in each markdown file."),(0,n.kt)("li",{parentName:"ul"},"In Next.js, the ",(0,n.kt)("inlineCode",{parentName:"li"},"lib")," folder does not have an assigned name like the ",(0,n.kt)("inlineCode",{parentName:"li"},"pages")," folder, so you can name it anything. It's usually convention to use ",(0,n.kt)("inlineCode",{parentName:"li"},"lib")," or ",(0,n.kt)("inlineCode",{parentName:"li"},"utils"),"."))),(0,n.kt)("h3",null,"Fetching the blog data"),(0,n.kt)("p",null,"Now that the blog data is parsed, we need to add it to our index page (",(0,n.kt)("inlineCode",{parentName:"p"},"pages/index.js"),"). We can do this with a Next.js data fetching method called ",(0,n.kt)("a",{parentName:"p",href:"/docs/basic-features/data-fetching#getstaticprops-static-generation"},(0,n.kt)("inlineCode",{parentName:"a"},"getStaticProps()")),". In the next section, we'll learn how to implement ",(0,n.kt)("inlineCode",{parentName:"p"},"getStaticProps()"),"."),(0,n.kt)(o.Z,{shadow:!0,alt:"Index Page",oversize:!1,src:"/static/images/learn/data-fetching/index-page.png",width:623,height:474,mdxType:"Image"}),(0,n.kt)("p",null,`Let’s do it on the next page!`))}m.isMDXComponent=!0}},e=>{var a=a=>e(e.s=a);e.O(0,[27,8746,4371,2878,4730,1324,1067,8590,2888,9774,179],()=>a(24530)),_N_E=e.O()}]);