(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2885],{56896:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/learn-pages-router/basics/data-fetching/with-data",function(){return a(37966)}])},25928:(e,t,a)=>{"use strict";a.d(t,{Z:()=>x});var n=a(58589),s=a(51853),o=a.n(s),r=a(10628),i=a(14517);function p(e,t){return l(t.root,e.root)&&l(t.rootMargin,e.rootMargin)&&l(t.threshold,e.thresholds)}function c(e){if(!/^-?\d*\.?\d+(?:px|%)$/.test(e))throw Error("rootMargin must be specified as a CSS margin property")}function l(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===t.length?e.every((a,n)=>l(e[n],t[n])):e===t}a(81324);let d=function(){let e=new Map;function t(t){return e.has(t)?e.get(t):e.set(t,new Map).get(t)}function a(e,a){for(let n of e){let e=t(a).get(n.target);e&&e(n)}}return{getObserver:function(t){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{root:t.root||null,rootMargin:function(e){let t=(e||"0px").trim().split(/\s+/);return t.forEach(c),t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t.join(" ")}(t.rootMargin),threshold:Array.isArray(e=t.threshold)?e:[void 0!==e?e:0]}}(t);for(let t of e.keys())if(p(t,a))return t;return null}(t)||new IntersectionObserver(a,t)},observeTarget:function(e,a,n){t(e).set(a,n),e.observe(a)},unobserveTarget:function(e,a){t(e).delete(a),e.unobserve(a)}}}(),{getObserver:h}=d,{observeTarget:m}=d,{unobserveTarget:u}=d;class g extends r.Component{static #e=this.defaultProps={disabled:!1,once:!1};componentDidMount(){this.observer=h(k(this.props)),this.observe()}UNSAFE_componentWillReceiveProps(e){let t=k(e);p(this.observer,t)||(this.unobserve(),this.observer=h(t),this.shouldReobserve=!0),this.props.disabled&&!e.disabled&&(this.shouldReobserve=!0),!this.props.disabled&&e.disabled&&this.unobserve()}componentDidUpdate(){this.shouldReobserve&&(this.observe(),this.shouldReobserve=!1)}componentWillUnmount(){this.unobserve()}observe(){this.props.disabled||m(this.observer,this.target,this.handleIntersect)}unobserve(){u(this.observer,this.target)}render(){return this.props.render?this.props.render({innerRef:this.handleTarget}):(0,r.cloneElement)(r.Children.only(this.props.children),{ref:this.handleTarget})}constructor(...e){super(...e),this.shouldReobserve=!1,this.handleTarget=e=>{if(null!==e&&"object"==typeof e&&!function(e){return e&&"function"==typeof e.getBoundingClientRect}(e))throw Error("Child did not forward the ref to a DOM element. Did you accidentally pass a class component?");this.target&&this.target!==e&&(this.unobserve(),this.shouldReobserve=!0),this.target=e},this.handleIntersect=e=>{this.props.onIntersect(e,this.props.value),this.props.once&&e.isIntersecting&&this.unobserve()}}}let k=e=>({root:e.root,rootMargin:e.rootMargin,threshold:e.threshold});function f(e){let{videoSrc:t,video:a,renderImage:s,src:o,alt:r}=e;return o?t||a?(0,n.jsx)("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,src:o}):s?s(e):(0,n.jsx)("img",{alt:r,src:o||null}):null}class N extends r.Component{static #e=this.defaultProps={lazy:!0};render(){let{caption:e,width:t,height:a,margin:s=40,video:r=!1,videoSrc:p,captionSpacing:c=null,renderImage:l,oversize:d=!0,float:h,lazy:m,shadow:u,style:k,...N}=this.props,x=`${String(a/t*100)}%`;return(0,n.jsx)(g,{disabled:!m,onIntersect:this.handleIntersect,once:!0,rootMargin:"20%",children:(0,n.jsxs)("figure",{className:o().dynamic([["622a55e2833827d7",[s,t?`width: ${t}px;`:"",u?"box-shadow: 0 8px 30px rgba(0,0,0,0.12)":"",t,s,s,t,h,s,h]]])+" "+((0,i.W)({oversize:t>650&&d,float:h&&t<520})||""),children:[(0,n.jsxs)("div",{className:o().dynamic([["622a55e2833827d7",[s,t?`width: ${t}px;`:"",u?"box-shadow: 0 8px 30px rgba(0,0,0,0.12)":"",t,s,s,t,h,s,h]]])+" container",children:[(0,n.jsx)("div",{style:{paddingBottom:x,...k},className:o().dynamic([["622a55e2833827d7",[s,t?`width: ${t}px;`:"",u?"box-shadow: 0 8px 30px rgba(0,0,0,0.12)":"",t,s,s,t,h,s,h]]]),children:(0,n.jsx)(f,{alt:N.alt,height:a,renderImage:l,video:r,videoSrc:p,width:t,...N,src:this.state.src})}),e?(0,n.jsx)("figcaption",{style:c?{marginTop:c}:{},className:o().dynamic([["622a55e2833827d7",[s,t?`width: ${t}px;`:"",u?"box-shadow: 0 8px 30px rgba(0,0,0,0.12)":"",t,s,s,t,h,s,h]]]),children:e}):null]}),(0,n.jsx)(o(),{id:"622a55e2833827d7",dynamic:[s,t?`width: ${t}px;`:"",u?"box-shadow: 0 8px 30px rgba(0,0,0,0.12)":"",t,s,s,t,h,s,h],children:`figure.__jsx-style-dynamic-selector{display:block;text-align:center;margin:${s}px 0}.container.__jsx-style-dynamic-selector{margin:0 auto;${t?`width: ${t}px;`:""}                max-width: 100%}@media screen and (max-width:320px){.container.__jsx-style-dynamic-selector{width:100%}}div.__jsx-style-dynamic-selector{-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);transform:translate3d(0,0,0);position:relative}figure.__jsx-style-dynamic-selector img,figure.__jsx-style-dynamic-selector video{height:100%;left:0;position:absolute;top:0;width:100%;${u?"box-shadow: 0 8px 30px rgba(0,0,0,0.12)":""}}figcaption.__jsx-style-dynamic-selector{color:#999;font-size:12px;margin:0;text-align:center}@media(min-width:1200px){figure.oversize.__jsx-style-dynamic-selector{width:${t}px;margin:${s}px 0 ${s}px -webkit-calc(((${t}px - 650px) / 2) * -1);margin:${s}px 0 ${s}px -moz-calc(((${t}px - 650px) / 2) * -1);margin:${s}px 0 ${s}px calc(((${t}px - 650px) / 2) * -1)}figure.float.__jsx-style-dynamic-selector{float:${h};margin:${s}px;margin-${h}:-150px}}`})]})})}constructor(...e){super(...e),this.state={src:this.props.lazy?void 0:this.props.videoSrc||this.props.src},this.handleIntersect=e=>{e.isIntersecting&&this.setState({src:this.props.videoSrc||this.props.src})}}}let x=function(e){return(0,n.jsx)(N,{...e,alt:""})}},37966:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c,meta:()=>r}),a(10628);var n=a(16942),s=a(18590),o=a(25928);let r={title:"Pre-rendering and Data Fetching",courseId:"basics",lessonId:"data-fetching",stepId:"with-data",subtitle:"Static Generation with and without Data"},i={meta:r},p=e=>{let{children:t}=e;return(0,n.kt)(s.Z,{meta:r},t)};function c(e){let{components:t,...a}=e;return(0,n.kt)(p,{...i,...a,components:t,mdxType:"MDXLayout"},(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"/docs/pages/building-your-application/rendering/static-site-generation"},"Static Generation")," can be done with and without data."),(0,n.kt)("p",null,`So far, all the pages we’ve created do not require fetching external data. Those pages will automatically be statically generated when the app is built for production.`),(0,n.kt)(o.Z,{shadow:!0,alt:"Static Generation without Data",oversize:!1,src:"/static/images/learn/data-fetching/static-generation-without-data.png",width:623,height:392,mdxType:"Image"}),(0,n.kt)("p",null,`However, for some pages, you might not be able to render the HTML without first fetching some external data. Maybe you need to access the file system, fetch external API, or query your database at build time. Next.js supports this case — `,(0,n.kt)("a",{parentName:"p",href:"https://nextjs.org/docs/basic-features/pages#static-generation-with-data"},"Static Generation ",(0,n.kt)("strong",{parentName:"a"},"with data")),` — out of the box.`),(0,n.kt)(o.Z,{shadow:!0,alt:"Static Generation with Data",oversize:!1,src:"/static/images/learn/data-fetching/static-generation-with-data.png",width:623,height:525,mdxType:"Image"}),(0,n.kt)("h3",null,"Static Generation with Data using ",(0,n.kt)("inlineCode",{parentName:"h3"},"getStaticProps")),(0,n.kt)("p",null,"How does it work? Well, in Next.js, when you export a page component, you can also export an ",(0,n.kt)("inlineCode",{parentName:"p"},"async")," function called ",(0,n.kt)("a",{parentName:"p",href:"/docs/basic-features/data-fetching#getstaticprops-static-generation"},(0,n.kt)("inlineCode",{parentName:"a"},"getStaticProps")),". If you do this, then:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docs/basic-features/data-fetching#getstaticprops-static-generation"},(0,n.kt)("inlineCode",{parentName:"a"},"getStaticProps")),` runs at build time in production, and…`),(0,n.kt)("li",{parentName:"ul"},"Inside the function, you can fetch external data and send it as props to the page.")),(0,n.kt)("pre",{className:"language-jsx"},(0,n.kt)("code",{parentName:"pre",className:"language-jsx"},(0,n.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,n.kt)("span",{parentName:"code",className:"token keyword module"},"default")," ",(0,n.kt)("span",{parentName:"code",className:"token keyword"},"function")," ",(0,n.kt)("span",{parentName:"code",className:"token function"},(0,n.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Home")),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,n.kt)("span",{parentName:"code",className:"token parameter"},"props"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"{")," ",(0,n.kt)("span",{parentName:"code",className:"token spread operator"},"...")," ",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"}"),`

`,(0,n.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,n.kt)("span",{parentName:"code",className:"token keyword"},"async")," ",(0,n.kt)("span",{parentName:"code",className:"token keyword"},"function")," ",(0,n.kt)("span",{parentName:"code",className:"token function"},"getStaticProps"),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,n.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"{"),`
  `,(0,n.kt)("span",{parentName:"code",className:"token comment"},"// Get external data from the file system, API, DB, etc."),`
  `,(0,n.kt)("span",{parentName:"code",className:"token keyword"},"const")," data ",(0,n.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,n.kt)("span",{parentName:"code",className:"token spread operator"},"..."),`

  `,(0,n.kt)("span",{parentName:"code",className:"token comment"},"// The value of the `props` key will be"),`
  `,(0,n.kt)("span",{parentName:"code",className:"token comment"},"//  passed to the `Home` component"),`
  `,(0,n.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"{"),`
    `,(0,n.kt)("span",{parentName:"code",className:"token literal-property property"},"props"),(0,n.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,n.kt)("span",{parentName:"code",className:"token spread operator"},"..."),`
  `,(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"}"),`
`,(0,n.kt)("span",{parentName:"code",className:"token punctuation"},"}"),`
`)),(0,n.kt)("p",null,"Essentially, ",(0,n.kt)("a",{parentName:"p",href:"/docs/basic-features/data-fetching#getstaticprops-static-generation"},(0,n.kt)("inlineCode",{parentName:"a"},"getStaticProps"))," allows you to tell Next.js: ",(0,n.kt)("em",{parentName:"p"},`"Hey, this page has some data dependencies — so when you pre-render this page at build time, make sure to resolve them first!"`)),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},(0,n.kt)("strong",{parentName:"p"},"Note"),": In development mode, ",(0,n.kt)("a",{parentName:"p",href:"/docs/basic-features/data-fetching#getstaticprops-static-generation"},(0,n.kt)("inlineCode",{parentName:"a"},"getStaticProps"))," runs on each request instead.")),(0,n.kt)("h3",null,`Let’s Use `,(0,n.kt)("inlineCode",{parentName:"h3"},"getStaticProps")),(0,n.kt)("p",null,`It’s easier to learn by doing, so starting from the next page, we’ll use `,(0,n.kt)("a",{parentName:"p",href:"/docs/basic-features/data-fetching#getstaticprops-static-generation"},(0,n.kt)("inlineCode",{parentName:"a"},"getStaticProps"))," to implement our blog."))}c.isMDXComponent=!0}},e=>{var t=t=>e(e.s=t);e.O(0,[27,8746,4371,2878,4730,1324,1067,8590,2888,9774,179],()=>t(56896)),_N_E=e.O()}]);